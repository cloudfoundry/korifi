apiVersion: v1
kind: ConfigMap
metadata:
  name: korifi-gatewayapi-router-config
  namespace: {{ .Releases.Namespace }}
data:
  config.yaml: |-
    builderName: {{ .Values.reconcilers.build }}
    runnerName: {{ .Values.reconcilers.run }}
    cfProcessDefaults:
      memoryMB: {{ .Values.gatewayapi-router.processDefaults.memoryMB }}
      diskQuotaMB: {{ .Values.gatewayapi-router.processDefaults.diskQuotaMB }}
    cfRootNamespace: {{ .Values.rootNamespace }}
    {{ - if not .Values.eksContainerRegistryRoleARN }}
    {{ - if .Values.containerRegistrySecrets }}
    containerRegistrySecretNames:
    {{ - range .Values.containerRegistrySecrets }}
    - {{ . | quote }}
    {{ - end }}
    {{ - else }}
    containerRegistrySecretNames:
    - {{ .Values.containerRegistrySecret | quote }}
    {{ - end }}
    {{ - end }}
    taskTTL: {{ .Values.gatewayapi-router.taskTTL }}
    namespaceLabels:
    {{ - range $key, $value := .Values.gatewayapi-router.namespaceLabels }}
      {{ $key }}: {{ $value }}
    {{ - end }}
    logLevel: { { .Values.logLevel } }
    networking:
      gatewayNamespace: { { .Release.Namespace } }-gateway
        gatewayName: korifi
    experimentalManagedServicesEnabled: { { .Values.experimental.managedServices.enabled } }
    trustInsecureServiceBrokers: { { .Values.experimental.managedServices.trustInsecureBrokers } }
